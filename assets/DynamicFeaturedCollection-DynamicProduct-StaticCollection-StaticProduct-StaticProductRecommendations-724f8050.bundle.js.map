{"version":3,"sources":["webpack:///./source/scripts/components/RichText.js","webpack:///./source/scripts/components/MessageBanner.js","webpack:///./source/scripts/components/Youtube.js","webpack:///./source/scripts/components/Vimeo.js","webpack:///./source/scripts/components/Video.js","webpack:///./source/scripts/components/ProductClickToZoom.js","webpack:///./source/scripts/components/ProductGallery.js","webpack:///./source/scripts/components/ProductDetails.js","webpack:///./source/scripts/helpers/Images.js","webpack:///./source/scripts/components/AddToCartFlyout.js","webpack:///./source/scripts/Layout.js","webpack:///./source/scripts/helpers/Quantity.js","webpack:///./source/scripts/Forms.js"],"names":["RichText","$el","_initExternalLinks","groupedContent","length","GroupedContent","get","layout","intelliparse","fitvids","unload","anchors","find","filter","i","el","href","indexOf","location","hostname","attr","MessageBanner","$window","$","window","$document","document","$body","body","$bannerTemplate","$banners","header","querySelector","events","on","event","_handleDocumentClick","target","_closeEsc","off","message","type","$banner","clone","addClass","html","append","_bindEvents","_show","$visibleBanners","each","index","banner","_hide","push","preventDefault","e","key","dismissBanners","one","removeClass","_removeBanner","forEach","splice","remove","$parent","parents","api","apiLoadedCallbacks","apiLoaded","onYouTubeIframeAPIReady","apiLoadedCallback","Youtube","videoUrl","loop","regex","id","match","onApiLoaded","_onApiLoaded","bind","isReady","onReady","_onReady","onReadyCallback","onStateChange","_onStateChange","onPlayCallback","$script","Promise","resolve","player","playVideo","pauseVideo","mute","destroy","playerVars","modestbranding","showinfo","controls","rel","playlist","YT","Player","videoId","state","data","PlayerState","BUFFERING","VimeoPlayer","urlParts","split","onProgress","_onProgress","onProgressCallback","play","pause","setVolume","catch","Vimeo","ready","then","Video","options","platform","getAttribute","trim","playButton","videoEl","onPlayClick","_onPlayClick","onPauseClick","_onPauseClick","autoplay","_autoplay","video","videoData","childNodes","addEventListener","classList","add","setTimeout","removeEventListener","ProductClickToZoom","settings","slides","originalThumbnails","startIndex","selectGalleryIndex","photoswipeDialog","thumbContainer","thumbScroller","thumbScrollerButtons","querySelectorAll","closeButton","selectedSlide","innerHTML","thumbnails","selectedIndex","thumb","thumbIndex","dataset","mediaType","newThumb","cloneNode","appendChild","rimg","watch","selectedThumb","EventHandler","photoswipeSlides","slide","src","zoom","msrc","h","imageHeight","w","imageWidth","bottomBarHeight","isGreaterThanBreakpoint","photoswipeOptions","barsSize","top","bottom","fullscreenEl","zoomEl","shareEl","counterEl","arrowEl","preloaderEl","closeOnScroll","showHideOpacity","history","clickToCloseNonZoomable","timeToIdle","timeToIdleOutside","click_to_zoom","isLessThanBreakpoint","getThumbBoundsFn","pageYScroll","pageYOffset","documentElement","scrollTop","bounds","getBoundingClientRect","x","left","y","width","photoswipe","PhotoSwipe","photoswipeUi","register","close","goTo","_handleScrollButtonVisibility","_onScrollButtonClick","mouseUsed","closeOnVerticalDrag","listen","getCurrentIndex","gallerySelected","slideIndex","_adjustMobileThumbPosition","removeTrapFocus","focus","unregisterAll","closeEsc","parentNode","init","trapFocus","thumbBounds","thumbWrapperBounds","scrollLeft","offsetLeft","scrollWidth","clientWidth","scrollRight","ProductGallery","isQuickshop","viewer","navigation","navScroller","navScrollerButtons","figures","zoomButton","selected","figure","thumbnail","models","videos","selectedVideo","selectedModel","showingInitialSlide","_setupSelectedVideo","features","name","version","onLoad","viewInYourSpaceEl","_onViewInYourSpaceClick","_onModelLibraryLoad","Shopify","loadFeatures","_setSlideHeight","_onThumbnailClick","onZoomButtonClick","stopPropagation","_openImageZoom","_onResize","_setupFlickity","_selectMediaByEl","variant","featured_media","unwatch","_closeImageZoom","_disableHoverZoom","_disableFlickity","onPlayListener","flickity","unbindDrag","onPauseListener","bindDrag","figureEl","modelEl","galleryIndex","fullscreenEnabled","ModelViewerUI","fullscreenElement","drift","_setupHoverZoom","_adjustGalleryPositioning","button","contains","parseInt","select","_selectMediaByIndex","currentTarget","shopifyModel3dId","setAttribute","figureIndex","media","selectedMediaType","defaultModelId","shouldAutoplay","gallery_video_autoplay","videoElement","Plyr","active","gallery_video_looping","hover_zoom","selectedImage","Drift","paneContainer","inlinePane","hoverBoundingBox","handleTouch","onShow","productMain","productAlt","onHide","disable","Flickity","accessibility","adaptiveHeight","cellSelector","contain","friction","freeScroll","initialIndex","lazyLoad","percentPosition","prevNextButtons","pageDots","selectedAttraction","setGallerySize","wrapAround","flickityEvent","pointer","cellElement","model","blur","swiped","unregister","containerHeight","storedImageHeight","height","style","thumbnail_position","productGalleryThumbs","firstChild","activeButton","activeElement","insertBefore","leftmostBounds","thumbStyle","currentStyle","getComputedStyle","thumbMargin","marginLeft","wrapped","Array","prototype","some","call","maxWidth","firstElementChild","_adjustMobileThumbnailPosition","imageZoom","ProductClicktoZoom","ProductDetails","$formArea","$details","context","product","useHistory","sectionId","initialVariant","variantHelper","atcCallbacks","$form","$productAtcButton","$productVariants","$productOptions","detailsLink","detailsBaseHref","variantFields","$price","$priceMoney","$compareAtPrice","$compareAtPriceMoney","$badge","$badgeMoneySaved","$badgePercentSaved","$sku","forms","Forms","gallery","_initOptions","_switchVariant","_AddToCartFlyout","ShopifyVariants","mixedControls","selectVariant","firstLoad","val","selectMediaByVariant","_updatePrice","_updateSKU","_updateBadge","_updateButton","_updateSwatchLabel","_updateFullDetailsLink","url","handle","param","replaceState","hasComparePrice","compare_at_price","price","toggleClass","text","formatMoney","money_format","CurrencyConverter","update","sku","parent","priceSaved","toggle","percentileSaved","Math","round","available","product_available","prop","product_unavailable","swatches_enable","swatchLabel","innerText","optionSwatchValue","formData","serializeArray","$atcButton","moneyFormat","cartRedirection","cart_redirection","AddToCartFlyout","Images","images","size","imageArray","loadImage","getSizedImageUrl","path","image","Image","removeProtocol","prefix","suffix","console","warn","replace","flyOutSelector","$atcTemplate","itemId","atcFlyOut","_onInit","_onError","_onSuccess","_onCloseAll","messageBanner","headerAnnouncement","$header","callbacks","extend","onInit","onError","onSuccess","onClose","_closeFlyOuts","_disableButton","_updateCart","_removeFlyOuts","$flyOut","quantityField","quantity","value","ajax","dataType","done","response","imageUrl","product_title","variant_options","join","$productPriceQuantity","secondResponse","lineItem","items","item","line_level_discount_allocations","concat","final_price","$productPriceValue","original_price","$productPriceDiscounted","show","hide","$productDiscounts","discountItemTemplate","children","first","empty","discount","$listItem","discount_application","title","$amount","amount","$subTotal","total_price","item_count","trigger","_openFlyOut","fail","errorText","responseText","JSON","parse","description","error","status","statusText","_enableButton","_closeFlyOut","$excludeFlyOut","is","_removeFlyOut","documentClickEventTarget","eventHandlers","previousBreakpoint","getBreakpoints","getPropertyValue","getBreakpoint","currentBreakpoint","eventHandler","previous","current","breakpoint","inclusive","breakpoints","comparison","isBreakpoint","onBreakpointChange","offBreakpointChange","Quantity","$inputParent","$input","$selectParent","$select","_watchSelect","_watchInput","baseValue","isNaN","_validateValue","removeAttr","selector","filledClass","fieldSelector","quantityItems","$quantityWrapper","_toggleFilled","_checkFilled","quantityItem","hasClass","$target","isFilled"],"mappings":"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","file":"DynamicFeaturedCollection-DynamicProduct-StaticCollection-StaticProduct-StaticProductRecommendations-724f8050.bundle.js","sourcesContent":["import fitvids from 'fitvids';\nimport GroupedContent from 'grouped-content';\n\nexport default class RichText {\n  constructor($el) {\n    this.$el = $el;\n    this._initExternalLinks();\n    this.groupedContent = null;\n\n    if (this.$el.length) {\n      this.groupedContent = new GroupedContent($el.get(0), {\n        layout: 'tabs',\n        intelliparse: false,\n      });\n\n      fitvids('.rte');\n    }\n  }\n\n  unload() {\n    if (this.groupedContent) {\n      this.groupedContent.unload();\n    }\n  }\n\n  /**\n   * Open links within an RTE field in a new window if they point to external domains\n   *\n   * @private\n   */\n  _initExternalLinks() {\n    const anchors = this.$el.find('a[href^=\"http\"]').filter((i, el) => el.href.indexOf(location.hostname) === -1);\n    anchors.attr('target', '_blank');\n  }\n}\n","import $ from 'jquery';\n\nexport default class MessageBanner {\n  constructor() {\n    this.$window = $(window);\n    this.$document = $(document);\n    this.$body = $(document.body);\n    this.$bannerTemplate = $('[data-templates] [data-message-banner]');\n    this.$banners = [];\n\n    this.header = document.querySelector('[data-site-header]');\n    this.events = [];\n\n    this.$document.on('touchstart.message-banner, click.message-banner', event => {\n      this._handleDocumentClick(event.target);\n    });\n\n    this.$window.on('keydown.message-banner', event => this._closeEsc(event));\n  }\n\n  unload() {\n    this.$document.off('touchstart.message-banner, click.message-banner');\n    this.$window.off('keydown.message-banner');\n  }\n\n  message(message, type) {\n    const $banner = this.$bannerTemplate.clone();\n\n    $banner\n      .addClass(`message--${type}`)\n      .find('[data-message-banner-content]')\n      .html(message);\n\n    $(this.header).append($banner);\n    this._bindEvents($banner);\n    this._show($banner);\n  }\n\n  dismissBanners() {\n    const $visibleBanners = $('[data-message-banner]:visible');\n\n    $visibleBanners.each((index, banner) => {\n      this._hide($(banner), index);\n    });\n  }\n\n  _bindEvents($banner) {\n    this.events.push([\n      $banner.on('click.message-banner', '[data-message-banner-close]', event => {\n        event.preventDefault();\n        this._hide($banner);\n      }),\n      this.$window.on('keydown.message-banner', e => {\n        if (e.key === 'Escape') {\n          this._hide($banner);\n        }\n      }),\n    ]);\n  }\n\n  _closeEsc(e) {\n    if (e.key === 'Escape') {\n      this.dismissBanners();\n    }\n  }\n\n  _show($banner) {\n    this.$banners.push($banner);\n\n    $banner\n      .addClass('animating animating-in')\n      .one('trend', () => {\n        $banner\n          .removeClass('animating animating-in')\n          .addClass('visible')\n          .off('trend');\n      });\n  }\n\n  _hide($banner, index = 0) {\n    $banner\n      .addClass('animating animating-out')\n      .one('trend', () => {\n        $banner\n          .removeClass('animating animating-out visible')\n          .off('trend');\n        this._removeBanner($banner, index);\n      });\n  }\n\n  _removeBanner($banner, index) {\n    if (this.events[index]) {\n      this.events[index].forEach($el => $el.off('.message-banner'));\n      this.events.splice(index, 1);\n    }\n\n    this.$banners.splice(index, 1);\n    $banner.remove();\n  }\n\n  _handleDocumentClick(target) {\n    const $parent = $(target).parents('[data-message-banner]');\n    if ($parent.length) return;\n\n    this.dismissBanners();\n  }\n}\n","import $script from 'scriptjs';\n\nconst api = 'https://www.youtube.com/iframe_api';\nlet apiLoadedCallbacks = [];\nlet apiLoaded = false;\n\nwindow.onYouTubeIframeAPIReady = () => {\n  apiLoadedCallbacks.forEach(apiLoadedCallback => apiLoadedCallback());\n  apiLoadedCallbacks = [];\n  apiLoaded = true;\n};\n\nexport default class Youtube {\n  constructor({ el, videoUrl, loop }) {\n    const regex = /(?:youtube\\.com\\/(?:[^\\/]+\\/.+\\/|(?:v|e(?:mbed)?)\\/|.*[?&]v=)|youtu\\.be\\/)([^\"&?\\/ ]{11})/i; // eslint-disable-line no-useless-escape\n\n    this.el = el;\n    this.id = videoUrl.match(regex)[1] || null;\n\n    this.onApiLoaded = this._onApiLoaded.bind(this);\n\n    this.isReady = false;\n    this.onReady = this._onReady.bind(this);\n    this.onReadyCallback = null;\n    this.loop = loop ? 1 : 0;\n\n    this.onStateChange = this._onStateChange.bind(this);\n    this.onPlayCallback = null;\n\n    if (apiLoaded) {\n      this._onApiLoaded();\n    } else {\n      apiLoadedCallbacks.push(this.onApiLoaded);\n      $script(api);\n    }\n  }\n\n  play() {\n    return new Promise(resolve => {\n      this.onPlayCallback = resolve;\n\n      if (this.isReady) {\n        this.player.playVideo();\n      } else {\n        this.onReadyCallback = () => { this.player.playVideo(); };\n      }\n    });\n  }\n\n  pause() {\n    return new Promise(resolve => {\n      this.onPlayCallback = resolve;\n\n      if (this.isReady) {\n        this.player.pauseVideo();\n      } else {\n        this.onReadyCallback = () => { this.player.pauseVideo(); };\n      }\n    });\n  }\n\n  autoplay() {\n    return new Promise(resolve => {\n      this.onPlayCallback = resolve;\n\n      if (this.isReady) {\n        this.player.playVideo();\n        this.player.mute();\n      } else {\n        this.onReadyCallback = () => {\n          this.player.playVideo();\n          this.player.mute();\n        };\n      }\n    });\n  }\n\n  unload() {\n    this.player.destroy();\n  }\n\n  _onApiLoaded() {\n    const playerVars = {\n      modestbranding: true,\n      showinfo: false,\n      controls: false,\n      loop: this.loop,\n      rel: 0,\n    };\n\n    if (this.loop) {\n      // This is required to allow 'loop' to work based on the YouTube api\n      playerVars.playlist = this.id;\n    }\n\n    this.player = new YT.Player(this.el, {\n      videoId: this.id,\n      playerVars,\n      events: {\n        onReady: this.onReady,\n        onStateChange: this.onStateChange,\n      },\n    });\n  }\n\n  _onReady() {\n    this.isReady = true;\n\n    if (this.onReadyCallback) {\n      this.onReadyCallback();\n    }\n  }\n\n  _onStateChange(event) {\n    const state = event.data;\n    if (\n      this.onPlayCallback\n      && state === YT.PlayerState.BUFFERING\n    ) {\n      this.onPlayCallback();\n      this.onPlayCallback = null;\n    }\n  }\n}\n","import $script from 'scriptjs';\n\nconst api = 'https://player.vimeo.com/api/player.js';\nlet apiLoaded = false;\n\nexport default class VimeoPlayer {\n  constructor({ el, videoUrl }) {\n    this.el = el;\n    const urlParts = videoUrl.split('/');\n\n    this.id = urlParts[urlParts.length - 1];\n    this.onReadyCallback = null;\n\n    this.onApiLoaded = this._onApiLoaded.bind(this);\n\n    this.onProgress = this._onProgress.bind(this);\n    this.onProgressCallback = null;\n\n    if (apiLoaded) {\n      this._onApiLoaded();\n    } else {\n      $script(api, this.onApiLoaded);\n    }\n  }\n\n  play() {\n    return new Promise(resolve => {\n      this.onProgressCallback = resolve;\n\n      if (apiLoaded) {\n        this.player.on('play', this.onProgress);\n        this.player.play();\n      } else {\n        this.onReadyCallback = () => {\n          this.player.on('play', this.onProgress);\n          this.player.play();\n        };\n      }\n    });\n  }\n\n  pause() {\n    return new Promise(resolve => {\n      this.onProgressCallback = resolve;\n\n      if (apiLoaded) {\n        this.player.on('pause', this.onProgress);\n        this.player.pause();\n      } else {\n        this.onReadyCallback = () => {\n          this.player.on('pause', this.onProgress);\n          this.player.pause();\n        };\n      }\n    });\n  }\n\n  autoplay() {\n    return new Promise(resolve => {\n      this.onProgressCallback = resolve;\n\n      if (apiLoaded) {\n        this.player.on('play', this.onProgress);\n        this.player.setVolume(0);\n        this.player.play();\n      } else {\n        this.onReadyCallback = () => {\n          this.player.on('play', this.onProgress);\n          this.player.setVolume(0);\n          this.player.play();\n        };\n      }\n    });\n  }\n\n  unload() {\n    this.player\n      .unload()\n      .catch();\n  }\n\n  _onApiLoaded() {\n    this.player = new window.Vimeo.Player(this.el, { id: this.id });\n\n    this.player\n      .ready()\n      .then()\n      .catch();\n\n    apiLoaded = true;\n\n    if (this.onReadyCallback) {\n      this.onReadyCallback();\n    }\n  }\n\n  _onProgress() {\n    this.player.off('play', this.onProgress);\n    this.player.off('pause', this.onProgress);\n\n    if (this.onProgressCallback) {\n      this.onProgressCallback();\n      this.onProgressCallback = null;\n    }\n  }\n}\n","import Youtube from './Youtube';\nimport Vimeo from './Vimeo';\n\nexport default class Video {\n  constructor(el, options) {\n    this.el = el;\n    this.options = options;\n    this.platform = el.getAttribute('data-video').trim();\n    this.playButton = el.querySelector('[data-video-play-button]');\n    this.videoEl = el.querySelector('[data-video-element]');\n\n    this.onPlayClick = this._onPlayClick.bind(this);\n    this.onPauseClick = this._onPauseClick.bind(this);\n    this.autoplay = this._autoplay.bind(this);\n\n    this.video = null;\n\n    this.videoData = {\n      el: this.videoEl.childNodes[0],\n      videoUrl: this.videoEl.getAttribute('data-video-url'),\n      loop: this.options && this.options.loop,\n    };\n\n    switch (this.platform) {\n      case 'youtube':\n        this.video = new Youtube(this.videoData);\n        break;\n      case 'vimeo':\n        this.video = new Vimeo(this.videoData);\n        break;\n      default:\n        this.video = null;\n        break;\n    }\n\n    this.el.addEventListener('click', this.onPlayClick);\n\n    if (this.playButton) {\n      if (this.options && this.options.autoplay) {\n        this.autoplay();\n      }\n\n      this.playButton.addEventListener('click', this.onPlayClick);\n    }\n  }\n\n  _onPlayClick() {\n    this.el.classList.add('video-loading');\n\n    this.video.play()\n      .then(() => {\n        this.el.classList.add('video-transitioning');\n\n        setTimeout(() => {\n          this.el.classList.remove('video-loading');\n          this.el.classList.remove('video-transitioning');\n          this.el.classList.add('video-playing');\n        }, 200);\n      });\n  }\n\n  _onPauseClick() {\n    this.video.pause();\n  }\n\n  _autoplay() {\n    this.el.classList.add('video-loading');\n\n    this.video.autoplay()\n      .then(() => {\n        this.el.classList.add('video-transitioning');\n\n        setTimeout(() => {\n          this.el.classList.remove('video-loading');\n          this.el.classList.remove('video-transitioning');\n          this.el.classList.add('video-playing');\n        }, 200);\n      });\n  }\n\n  play() {\n    this._onPlayClick();\n  }\n\n  pause() {\n    this._onPauseClick();\n  }\n\n  unload() {\n    this.el.removeEventListener('click', this.onPlayClick);\n\n    if (this.playButton) {\n      this.playButton.removeEventListener('click', this.onPlayClick);\n    }\n\n    if (this.video) {\n      this.video.unload();\n    }\n  }\n\n  destroy() {\n    this.unload();\n  }\n}\n","import PhotoSwipe from 'photoswipe';\nimport EventHandler from '@pixelunion/events';\nimport rimg from 'rimg-shopify';\nimport {\n  trapFocus,\n  removeTrapFocus,\n} from '@shopify/theme-a11y';\n\nimport photoswipeUi from '../../../node_modules/photoswipe/dist/photoswipe-ui-default';\n\nimport layout from '../Layout';\n\nexport default class ProductClickToZoom {\n  constructor({\n    settings,\n    slides,\n    originalThumbnails,\n    startIndex,\n    selectGalleryIndex,\n  }) {\n    this.settings = settings;\n\n    this.photoswipeDialog = document.querySelector('[data-photoswipe]');\n    this.thumbContainer = this.photoswipeDialog.querySelector('[data-photoswipe-thumbs]');\n    this.thumbScroller = this.photoswipeDialog.querySelector('[data-photoswipe-thumb-scroller]');\n    this.thumbScrollerButtons = this.photoswipeDialog.querySelectorAll('[data-gallery-scroll-button]');\n    this.closeButton = this.photoswipeDialog.querySelector('.pswp__button--close');\n    this.selectedSlide = slides[startIndex];\n\n    this.thumbScroller.innerHTML = '';\n    this.thumbnails = [];\n\n    let selectedIndex = startIndex;\n\n    // Clone the original thumbnails into the photoswipe dialog\n    originalThumbnails.forEach((thumb, thumbIndex) => {\n      if (thumb.dataset.mediaType !== 'image') {\n        if (startIndex > thumbIndex) selectedIndex--;\n        return;\n      }\n      const newThumb = thumb.cloneNode(true);\n      this.thumbScroller.appendChild(newThumb);\n      this.thumbnails.push(newThumb);\n    });\n\n    rimg.watch(this.thumbContainer);\n\n    this.selectedThumb = this.thumbContainer.querySelector('[data-gallery-selected=\"true\"]');\n\n    this.events = new EventHandler();\n\n    // Set up options for initializing PhotoSwipe\n    const photoswipeSlides = [];\n\n    slides.forEach(slide => {\n      if (['video', 'external_video', 'model'].indexOf(slide.dataset.mediaType) > -1) return;\n      photoswipeSlides.push({\n        src: slide.dataset.zoom,\n        msrc: slide.dataset.zoom,\n        h: slide.dataset.imageHeight,\n        w: slide.dataset.imageWidth,\n      });\n    });\n\n    // Adjust the bottom bar height to allow for the mobile thumbnails\n    const bottomBarHeight = layout.isGreaterThanBreakpoint('L', true) ? 0 : 75;\n\n    const photoswipeOptions = {\n      index: selectedIndex,\n      barsSize: { top: 0, bottom: bottomBarHeight },\n      fullscreenEl: false,\n      zoomEl: false,\n      shareEl: false,\n      counterEl: false,\n      arrowEl: false,\n      preloaderEl: false,\n      closeOnScroll: false,\n      showHideOpacity: true,\n      history: false,\n      loop: true,\n      clickToCloseNonZoomable: false,\n      timeToIdle: false,\n      timeToIdleOutside: false,\n    };\n\n    if (this.settings.click_to_zoom === 'always'\n      || (layout.isGreaterThanBreakpoint('S', true) && this.settings.click_to_zoom === 'desktop')\n      || (layout.isLessThanBreakpoint('S') && this.settings.click_to_zoom === 'mobile')) {\n      photoswipeOptions.getThumbBoundsFn = () => {\n        const pageYScroll = window.pageYOffset || document.documentElement.scrollTop;\n        const bounds = this.selectedSlide.querySelector('[data-rimg]').getBoundingClientRect();\n        return { x: bounds.left, y: bounds.top + pageYScroll, w: bounds.width };\n      };\n    }\n\n    this.photoswipe = new PhotoSwipe(\n      this.photoswipeDialog,\n      photoswipeUi,\n      photoswipeSlides,\n      photoswipeOptions,\n    );\n\n    this.events.register(this.closeButton, 'click', () => this.photoswipe.close());\n    // The following fixes an issue on iOS12 and below, where click events were not registering\n    this.events.register(this.closeButton, 'touchstart', () => this.photoswipe.close());\n\n    this.thumbnails.forEach((thumb, index) => {\n      this.events.register(thumb, 'click', () => {\n        this.photoswipe.goTo(index);\n      });\n    });\n\n    this.events.register(this.thumbScroller, 'scroll', () => this._handleScrollButtonVisibility());\n    this.events.register(this.thumbScrollerButtons[0], 'click', () => this._onScrollButtonClick(true));\n    this.events.register(this.thumbScrollerButtons[1], 'click', () => this._onScrollButtonClick(false));\n\n    // Photoswipe documentation claims that the closeOnVerticalDrag option is always false if\n    // the mouse is used, which is what we want. Unfortunately that's not how it actually works,\n    // so we need to dynamically update the setting when a mouse is detected.\n    if (this.photoswipe.options.mouseUsed) {\n      this.photoswipe.options.closeOnVerticalDrag = false;\n    } else {\n      this.photoswipe.listen('mouseUsed', () => {\n        this.photoswipe.options.closeOnVerticalDrag = false;\n      });\n    }\n\n    this.photoswipe.listen('afterChange', () => {\n      const index = this.photoswipe.getCurrentIndex();\n      if (this.selectedThumb) {\n        this.selectedThumb.dataset.gallerySelected = false;\n      }\n      this.selectedThumb = this.thumbnails[index];\n      this.selectedThumb.dataset.gallerySelected = true;\n\n      const slideIndex = this.selectedThumb.getAttribute('data-gallery-index');\n      const slide = slides[slideIndex];\n\n      this._adjustMobileThumbPosition();\n      this._handleScrollButtonVisibility();\n\n      selectGalleryIndex(slideIndex);\n      this.selectedSlide = slide;\n    });\n\n    this.photoswipe.listen('close', () => {\n      removeTrapFocus(this.photoswipeDialog);\n      this.selectedSlide.focus();\n      this.photoswipe = null;\n    });\n\n    this.photoswipe.listen('destroy', () => {\n      this.events.unregisterAll();\n      this.photoswipe = null;\n    });\n\n    // Detect if mouse is over the thumbnails, if it is allow scroll left/right\n    this.events.register(this.thumbContainer, 'mouseenter', () => {\n      if (layout.isLessThanBreakpoint('S')) {\n        this.photoswipe.options.closeOnScroll = true;\n      }\n    });\n\n    this.events.register(this.thumbContainer, 'mouseleave', () => {\n      if (layout.isLessThanBreakpoint('S')) {\n        this.photoswipe.options.closeOnScroll = false;\n      }\n    });\n\n    // If a user closes the dialog using the escape key, then we should focus\n    // on the expand button.\n    const closeEsc = e => {\n      if (e.key === 'Escape') {\n        slides[0].parentNode.querySelector('[data-gallery-expand]').focus();\n      }\n    };\n\n    this.events.register(window, 'keydown', e => closeEsc(e));\n\n    this.photoswipe.init();\n\n    trapFocus(this.photoswipeDialog);\n  }\n\n  _adjustMobileThumbPosition() {\n    // This brings the thumbnail into view if it is not visible on the screen after\n    // a user swipes to a slide that it is tied to.\n    if (layout.isLessThanBreakpoint('S')) {\n      const thumbBounds = this.selectedThumb.getBoundingClientRect();\n      const thumbWrapperBounds = this.thumbScroller.getBoundingClientRect();\n\n      if (thumbBounds.left + thumbBounds.width + 30 > thumbWrapperBounds.width) {\n        this.thumbScroller.scrollLeft = this.selectedThumb.offsetLeft\n          + thumbBounds.width - thumbWrapperBounds.width + 35;\n      } else if (this.selectedThumb.offsetLeft < this.thumbScroller.scrollLeft) {\n        this.thumbScroller.scrollLeft = this.selectedThumb.offsetLeft - 35;\n      }\n    }\n  }\n\n  _handleScrollButtonVisibility() {\n    if (layout.isLessThanBreakpoint('S')) {\n      // We use 4px here just to ensure the user has scrolled a little bit before\n      // showing the buttons.\n      if (this.thumbScroller.scrollLeft > 4) {\n        this.thumbScrollerButtons[0].classList.add('visible');\n      } else {\n        this.thumbScrollerButtons[0].classList.remove('visible');\n      }\n\n      if (this.thumbScroller.scrollLeft < this.thumbScroller.scrollWidth\n        - this.thumbScroller.clientWidth) {\n        this.thumbScrollerButtons[1].classList.add('visible');\n      } else {\n        this.thumbScrollerButtons[1].classList.remove('visible');\n      }\n    } else {\n      this.thumbScrollerButtons[0].classList.remove('visible');\n      this.thumbScrollerButtons[1].classList.remove('visible');\n    }\n  }\n\n  _onScrollButtonClick(scrollRight) {\n    if (scrollRight) {\n      this.thumbScroller.scrollLeft = this.thumbScroller.scrollLeft - 100;\n    } else {\n      this.thumbScroller.scrollLeft = this.thumbScroller.scrollLeft + 100;\n    }\n  }\n\n  unload() {\n    if (this.photoswipe) {\n      this.photoswipe.destroy();\n      this.photoswipe = null;\n    }\n  }\n}\n","import Drift from 'drift-zoom';\nimport Flickity from 'flickity';\nimport EventHandler from '@pixelunion/events';\nimport rimg from 'rimg-shopify';\n\nimport layout from '../Layout';\nimport Video from './Video';\nimport ProductClicktoZoom from './ProductClickToZoom';\n\nexport default class ProductGallery {\n  constructor({ el, settings, isQuickshop }) {\n    this.el = el;\n    this.settings = settings;\n    this.isQuickshop = isQuickshop || false;\n\n    this.events = new EventHandler();\n    this.viewer = this.el.querySelector('[data-gallery-viewer]');\n    this.navigation = this.el.querySelector('[data-gallery-navigation]');\n    this.navScroller = this.el.querySelector('[data-gallery-scroller]');\n    this.navScrollerButtons = this.el.querySelectorAll('[data-gallery-scroll-button]');\n    this.figures = this.viewer.querySelectorAll('[data-gallery-figure]');\n    this.thumbnails = this.navigation.querySelectorAll('[data-gallery-thumbnail]');\n    this.zoomButton = this.viewer.querySelector('[data-gallery-expand]');\n\n    this.selected = {\n      figure: this.viewer.querySelector('[data-gallery-selected=\"true\"]'),\n      thumbnail: this.navigation.querySelector('[data-gallery-selected=\"true\"]'),\n    };\n\n    this.models = {};\n    this.videos = {};\n    this.selectedVideo = null;\n    this.selectedModel = null;\n    this.showingInitialSlide = true;\n\n    this._setupSelectedVideo = this._setupSelectedVideo.bind(this);\n\n    const features = [];\n    if (this.el.querySelector('[data-media-type=\"video\"]')) {\n      features.push({\n        name: 'video-ui',\n        version: '1.0',\n        onLoad: () => this._setupSelectedVideo(),\n      });\n    }\n\n    if (this.el.querySelector('[data-media-type=\"model\"]')) {\n      this.viewInYourSpaceEl = this.el.querySelector('[data-shopify-xr]');\n      this.events.register(this.viewInYourSpaceEl, 'click', () => this._onViewInYourSpaceClick());\n\n      features.push(\n        {\n          name: 'model-viewer-ui',\n          version: '1.0',\n          onLoad: this._onModelLibraryLoad.bind(this),\n        },\n      );\n      features.push(\n        {\n          name: 'shopify-xr',\n          version: '1.0',\n        },\n      );\n    }\n\n    if (features.length) {\n      window.Shopify.loadFeatures(features);\n    }\n\n    if (this.isQuickshop) {\n      rimg.watch(this.el);\n      // Because of the way the quickshop is animated to open, if a video is first in the\n      // gallery the height of the slide will not be correct, so we need to wait until all the\n      // transitions end. This will only fire once, as opposed to listening to transitionend.\n      if (this.figures[0].dataset.mediaType === 'video') {\n        setTimeout(() => this._setSlideHeight(), 800);\n      }\n    }\n\n    this.events.register(this.navScroller, 'click', e => this._onThumbnailClick(e));\n    this.events.register(this.navScroller, 'scroll', () => this._handleScrollButtonVisibility());\n    this.events.register(this.navScrollerButtons[0], 'click', () => this._onScrollButtonClick(true));\n    this.events.register(this.navScrollerButtons[1], 'click', () => this._onScrollButtonClick(false));\n\n    if (this.settings.click_to_zoom !== 'disabled') {\n      const onZoomButtonClick = e => {\n        e.stopPropagation();\n        this._openImageZoom();\n      };\n\n      this.events.register(this.zoomButton, 'click', e => onZoomButtonClick(e));\n      this.events.register(this.viewer, 'click', e => onZoomButtonClick(e));\n    }\n\n    this._onResize = this._onResize.bind(this);\n    this.events.register(window, 'resize', () => this._onResize());\n\n    if (layout.isLessThanBreakpoint('S')) {\n      this._setupFlickity();\n      this._handleScrollButtonVisibility();\n    }\n\n    this._selectMediaByEl(this.selected.figure);\n  }\n\n  selectMediaByVariant(variant) {\n    if (!variant.featured_media) return;\n    const slide = this.viewer.querySelector(`[data-media=\"${variant.featured_media.id}\"]`);\n\n    this._selectMediaByEl(slide);\n  }\n\n  unload() {\n    this.events.unregisterAll();\n\n    for (let i; i < this.figures.length; i++) {\n      if (this.models[i]) {\n        this.models[i].destroy();\n      }\n\n      if (this.videos[i]) {\n        this.videos[i].destroy();\n      }\n    }\n\n    if (this.isQuickshop) {\n      rimg.unwatch(this.el);\n    }\n\n    this._closeImageZoom();\n    this._disableHoverZoom();\n    this._disableFlickity();\n  }\n\n  _onModelLibraryLoad() {\n    const onPlayListener = () => {\n      if (this.flickity) {\n        this.flickity.unbindDrag();\n      }\n    };\n    const onPauseListener = () => {\n      if (this.flickity) {\n        this.flickity.bindDrag();\n      }\n    };\n    this.el.querySelectorAll('.product-gallery--model')\n      .forEach(figureEl => {\n        const modelEl = figureEl.querySelector('model-viewer');\n        const { galleryIndex } = figureEl.dataset;\n        const controls = ['zoom-in', 'zoom-out'];\n        if (document.fullscreenEnabled) controls.push('fullscreen');\n\n        this.models[galleryIndex] = new Shopify.ModelViewerUI(modelEl, { controls });\n\n        this.events.register(modelEl, 'shopify_model_viewer_ui_toggle_play', onPlayListener);\n        this.events.register(modelEl, 'shopify_model_viewer_ui_toggle_pause', onPauseListener);\n      });\n  }\n\n  _onResize() {\n    // If the resize was trigger by a fullscreen, do not do anything\n    if (document.fullscreenElement) {\n      return;\n    }\n\n    if (layout.isGreaterThanBreakpoint('S', true)) {\n      this._disableFlickity();\n    } else {\n      this._setupFlickity();\n    }\n\n    if (layout.isGreaterThanBreakpoint('L', true) && !this.drift) {\n      this._setupHoverZoom();\n    } else if (layout.isLessThanBreakpoint('L')) {\n      this._disableHoverZoom();\n    }\n\n    this._adjustGalleryPositioning();\n    this._handleScrollButtonVisibility();\n  }\n\n  _onThumbnailClick(e) {\n    let button;\n    this.showingInitialSlide = false;\n\n    // The target will be the button itself if the user is using a keyboard to navigate, but\n    // otherwise it will be the image that is clicked on.\n    if (e.target.classList.contains('product-gallery--media-thumbnail')) {\n      button = e.target;\n    } else if (e.target.parentNode.parentNode.classList\n      .contains('product-gallery--media-thumbnail')) {\n      button = e.target.parentNode.parentNode;\n    } else {\n      return;\n    }\n\n    const selectedIndex = parseInt(button.dataset.galleryIndex, 10);\n\n    if (this.flickity) {\n      this.flickity.select(selectedIndex);\n    } else {\n      this._selectMediaByIndex(selectedIndex);\n    }\n  }\n\n  _onViewInYourSpaceClick(e) {\n    const { currentTarget } = e;\n    const figure = this.viewer.querySelector(`[data-media=\"${currentTarget.dataset.shopifyModel3dId}\"]`);\n\n    this._selectMediaByEl(figure);\n  }\n\n  _selectMediaByEl(el) {\n    this._selectMediaByIndex(parseInt(el.dataset.galleryIndex, 10));\n  }\n\n  _selectMediaByIndex(index) {\n    const figure = this.figures[index];\n\n    this.selected.figure.dataset.gallerySelected = false;\n    this.selected.figure.setAttribute('aria-hidden', true);\n    this.selected.figure = figure;\n    this.selected.figure.dataset.gallerySelected = true;\n    this.selected.figure.setAttribute('aria-hidden', false);\n\n    const figureIndex = parseInt(this.selected.figure.dataset.galleryIndex, 10);\n\n    this.selected.thumbnail.dataset.gallerySelected = false;\n    this.selected.thumbnail = this.thumbnails[figureIndex];\n    this.selected.thumbnail.dataset.gallerySelected = true;\n\n    const { media, mediaType } = this.selected.figure.dataset;\n\n    this.viewer.dataset.selectedMediaType = mediaType;\n\n    this._disableHoverZoom();\n\n    if (this.selectedModel) {\n      this.selectedModel.pause();\n    }\n\n    if (this.models[figure.dataset.galleryIndex]) {\n      this.selectedModel = this.models[figure.dataset.galleryIndex];\n      if (!document.documentElement.classList.contains('has-touch') && !this.showingInitialSlide) {\n        this.selectedModel.play();\n      }\n    }\n\n    if (this.selectedVideo) {\n      this.selectedVideo.pause();\n    }\n\n    if (this.viewInYourSpaceEl) {\n      this.viewInYourSpaceEl.dataset.shopifyModel3dId = this.viewInYourSpaceEl.dataset.defaultModelId;\n    }\n\n    switch (mediaType) {\n      case 'model':\n        this.viewInYourSpaceEl.dataset.shopifyModel3dId = media;\n        break;\n      case 'video':\n      case 'external_video':\n        this._setupSelectedVideo();\n        break;\n      case 'image':\n        this._setupHoverZoom();\n        break;\n      default: break;\n    }\n\n    if (this.flickity) {\n      this.flickity.bindDrag();\n      this.flickity.select(index);\n    }\n\n    this._adjustGalleryPositioning();\n  }\n\n  _setupSelectedVideo() {\n    if (this.selectedVideo) {\n      this.selectedVideo.pause();\n    }\n\n    const { mediaType, galleryIndex } = this.selected.figure.dataset;\n    const shouldAutoplay = layout.isGreaterThanBreakpoint('L', true)\n      && this.settings.gallery_video_autoplay\n      && !this.showingInitialSlide;\n\n    if (mediaType === 'video' || mediaType === 'external_video') {\n      let videoElement;\n\n      if (this.videos[galleryIndex]) {\n        this.selectedVideo = this.videos[galleryIndex];\n        if (shouldAutoplay) this.selectedVideo.play();\n      } else {\n        if (mediaType === 'video') {\n          // Plyr hasn't loaded yet, will be called again after loadFeatures\n          if (!Shopify.Plyr) return;\n          videoElement = this.selected.figure.querySelector('video');\n\n          this.selectedVideo = new Shopify.Plyr(videoElement, {\n            loop: { active: this.settings.gallery_video_looping },\n          });\n          if (shouldAutoplay) this.selectedVideo.play();\n        } else {\n          videoElement = this.selected.figure.querySelector('[data-video]');\n          this.selectedVideo = new Video(videoElement, {\n            loop: this.settings.gallery_video_looping,\n          });\n          if (shouldAutoplay) this.selectedVideo.play();\n        }\n        this.videos[galleryIndex] = this.selectedVideo;\n      }\n      this.selected.figure.focus();\n    }\n  }\n\n  _setupHoverZoom() {\n    if (\n      this.settings.hover_zoom === 'disabled'\n      || !layout.isGreaterThanBreakpoint('L', true)\n      || this.selected.figure.dataset.mediaType !== 'image'\n      || document.documentElement.classList.contains('has-touch')\n    ) return;\n\n    const selectedImage = this.selected.figure.querySelector('[data-rimg]');\n    selectedImage.setAttribute('data-zoom', this.selected.figure.getAttribute('data-zoom'));\n\n    this.drift = new Drift(selectedImage, {\n      paneContainer: this.settings.hover_zoom === 'separate'\n        ? this.el.querySelector('[data-zoomed-image]')\n        : this.selected.figure,\n      inlinePane: false,\n      hoverBoundingBox: this.settings.hover_zoom === 'separate',\n      handleTouch: false,\n      onShow: () => {\n        if (this.settings.hover_zoom === 'separate') {\n          const productMain = document.querySelector('.product-main');\n          const productAlt = document.querySelector('.product-form--alt');\n          productMain.classList.add('product-gallery--fade');\n          if (productAlt) productAlt.classList.add('product-gallery--fade');\n        }\n      },\n      onHide: () => {\n        if (this.settings.hover_zoom === 'separate') {\n          const productMain = document.querySelector('.product-main');\n          const productAlt = document.querySelector('.product-form--alt');\n          productMain.classList.remove('product-gallery--fade');\n          if (productAlt) productAlt.classList.remove('product-gallery--fade');\n        }\n      },\n    });\n  }\n\n  _disableHoverZoom() {\n    if (this.drift) {\n      this.drift.disable();\n      this.drift = null;\n    }\n  }\n\n  _setupFlickity() {\n    if (\n      this.flickity\n      || !layout.isLessThanBreakpoint('S')\n    ) return;\n\n    this.flickity = new Flickity(this.viewer, {\n      accessibility: false,\n      adaptiveHeight: true,\n      cellSelector: '.product-gallery--media',\n      contain: true,\n      friction: 0.5,\n      freeScroll: false,\n      initialIndex: parseInt(this.selected.figure.dataset.galleryIndex, 10),\n      lazyLoad: false,\n      percentPosition: false,\n      prevNextButtons: false,\n      pageDots: false,\n      selectedAttraction: 0.1,\n      setGallerySize: false,\n      wrapAround: true,\n    });\n\n    this.flickityEvent = this.events.register(this.viewer, 'rimg:load', () => {\n      this._setSlideHeight();\n    });\n\n    this.flickity.on('change', index => {\n      this.showingInitialSlide = false;\n      this._selectMediaByEl(this.figures[index]);\n    });\n\n    // Flickity controls the pointerdown event which prevents model-viewer-ui from\n    // triggering .play() on mouseup. This returns this functionality.\n    this.flickity.on('staticClick', (event, pointer, cellElement) => {\n      const figure = cellElement.querySelector('.product-gallery--model');\n\n      if (figure && this.models[figure.dataset.galleryIndex]) {\n        const model = this.models[figure.dataset.galleryIndex];\n        model.play();\n      }\n    });\n\n    this.flickity.on('pointerDown', () => {\n      // Removes the focus ring when swiping with touch device\n      this.viewer.blur();\n    });\n\n    // We need to disable the product zoom open if a user is swiping\n    // This was an issue on mouse gestures, not on touch\n    if (this.settings.click_to_zoom !== 'disabled'\n      && document.documentElement.classList.contains('no-touch')) {\n      this.flickity.on('dragEnd', () => {\n        this.swiped = true;\n      });\n    }\n\n    this._setSlideHeight();\n  }\n\n  _disableFlickity() {\n    if (this.flickity) {\n      this.flickity.destroy();\n      this.flickity = null;\n      this.events.unregister(this.flickityEvent);\n    }\n  }\n\n  _setSlideHeight() {\n    this.navigation.classList.remove('loading');\n\n    // Use the stored image height for situations where the DOM is in a midway state.\n    const containerHeight = this.storedImageHeight\n      || this.selected.figure.getBoundingClientRect().height;\n    this.storedImageHeight = null;\n\n    this.viewer.style.height = `${containerHeight}px`;\n  }\n\n  _adjustGalleryPositioning() {\n    if (this.settings.thumbnail_position === 'left') {\n      if (this.isQuickshop) {\n        if (layout.isGreaterThanBreakpoint('L', true)) {\n          this.el.dataset.productGalleryThumbs = 'left';\n        } else {\n          this.storedImageHeight = this.selected.figure.getBoundingClientRect().height;\n          this.el.dataset.productGalleryThumbs = 'center';\n        }\n      }\n\n      // We need to adjust the width of the thumbnails if they are positioned left\n      // and they wrap into 2 columns. CSS flexbox does not cause the width of the\n      // element to stretch. Looks like it's a problem with flexbox when wrapping columns:\n      // https://stackoverflow.com/questions/33891709/when-flexbox-items-wrap-in-column-mode-container-does-not-grow-its-width\n      if (layout.isGreaterThanBreakpoint('L', true)\n        || (layout.isGreaterThanBreakpoint('S', true) && !this.isQuickshop)) {\n        if (this.el.firstChild !== this.navigation) {\n          const activeButton = document.activeElement;\n          this.el.insertBefore(this.navigation, this.viewer);\n          activeButton.focus(); // This prevents loss of focus if one of the thumbnails are selected\n        }\n\n        // When switching layouts in the editor sometimes we need to wait for a few milliseconds\n        // before positioning the thumbs. The Quickshop is even a bit slower.\n        setTimeout(() => {\n          const leftmostBounds = this.thumbnails[0].getBoundingClientRect();\n          const thumbStyle = this.thumbnails[0].currentStyle\n            || window.getComputedStyle(this.thumbnails[0]);\n          const thumbMargin = (parseInt(thumbStyle.marginLeft, 10)) * 2;\n          const wrapped = Array.prototype.some.call(this.thumbnails,\n            thumb => thumb.getBoundingClientRect().left > leftmostBounds.left);\n          if (wrapped) {\n            this.navigation.style.width = `${(leftmostBounds.width + thumbMargin) * 2}px`;\n            this.navigation.style.maxWidth = `${(leftmostBounds.width + thumbMargin) * 2}px`;\n          }\n          this._setSlideHeight();\n        }, this.isQuickshop ? 500 : 100);\n      } else {\n        if (this.el.firstElementChild === this.navigation) {\n          this.el.appendChild(this.navigation);\n        }\n        this.navigation.style.width = '';\n        this.navigation.style.maxWidth = '';\n        this._setSlideHeight();\n      }\n\n      if (layout.isLessThanBreakpoint('S')) {\n        this._adjustMobileThumbnailPosition();\n      }\n    } else {\n      this._setSlideHeight();\n      this._adjustMobileThumbnailPosition();\n    }\n  }\n\n  _adjustMobileThumbnailPosition() {\n    // This brings the thumbnail into view if it is not visible on the screen after\n    // a user swipes to a slide that it is tied to. Only important on mobile.\n    if (layout.isLessThanBreakpoint('S')) {\n      const thumbBounds = this.selected.thumbnail.getBoundingClientRect();\n      const thumbWrapperBounds = this.navScroller.getBoundingClientRect();\n\n      if (this.selected.thumbnail.offsetLeft + thumbBounds.width + 30\n        - this.navScroller.scrollLeft > thumbWrapperBounds.width) {\n        this.navScroller.scrollLeft = this.selected.thumbnail.offsetLeft\n          + thumbBounds.width - thumbWrapperBounds.width + 35;\n      } else if (this.selected.thumbnail.offsetLeft < this.navScroller.scrollLeft) {\n        this.navScroller.scrollLeft = this.selected.thumbnail.offsetLeft - 35;\n      }\n    }\n  }\n\n  _handleScrollButtonVisibility() {\n    if (layout.isLessThanBreakpoint('S')) {\n      // We use 4px here just to ensure the user has scrolled a little bit before\n      // showing the buttons.\n      if (this.navScroller.scrollLeft > 4) {\n        this.navScrollerButtons[0].classList.add('visible');\n      } else {\n        this.navScrollerButtons[0].classList.remove('visible');\n      }\n\n      if (this.navScroller.scrollLeft < this.navScroller.scrollWidth\n        - this.navScroller.clientWidth) {\n        this.navScrollerButtons[1].classList.add('visible');\n      } else {\n        this.navScrollerButtons[1].classList.remove('visible');\n      }\n    } else {\n      this.navScrollerButtons[0].classList.remove('visible');\n      this.navScrollerButtons[1].classList.remove('visible');\n    }\n  }\n\n  _onScrollButtonClick(scrollRight) {\n    if (scrollRight) {\n      this.navScroller.scrollLeft = this.navScroller.scrollLeft - 100;\n    } else {\n      this.navScroller.scrollLeft = this.navScroller.scrollLeft + 100;\n    }\n  }\n\n  _closeImageZoom() {\n    if (this.imageZoom) {\n      this.imageZoom.unload();\n      this.imageZoom = null;\n    }\n  }\n\n  _openImageZoom() {\n    if (this.selected.figure.dataset.mediaType !== 'image'\n      || (layout.isGreaterThanBreakpoint('L') && this.settings.click_to_zoom === 'mobile')\n      || (layout.isLessThanBreakpoint('L') && this.settings.click_to_zoom === 'desktop')\n    ) return;\n\n    if (this.swiped) {\n      this.swiped = false;\n      return;\n    }\n\n    this._closeImageZoom();\n\n    this.imageZoom = new ProductClicktoZoom({\n      settings: this.settings,\n      slides: this.figures,\n      originalThumbnails: this.thumbnails,\n      startIndex: parseInt(this.selected.figure.dataset.galleryIndex, 10),\n      selectGalleryIndex: index => this._selectMediaByIndex(index),\n    });\n  }\n}\n","import $ from 'jquery';\nimport CurrencyConverter from 'shopify-currency-converter';\nimport ShopifyVariants from 'shopify-variants';\nimport Forms from '../Forms';\nimport AddToCartFlyout from './AddToCartFlyout';\nimport ProductGallery from './ProductGallery';\n\nexport default class ProductDetails {\n  constructor(options) {\n    this.$window = $(window);\n    this.$formArea = options.$formArea;\n    this.$details = options.$details;\n    this.context = options.context;\n    this.settings = options.settings;\n    this.product = options.product;\n    this.useHistory = options.useHistory;\n    this.sectionId = options.sectionId;\n    this.initialVariant = options.initialVariant || null;\n\n    this.variantHelper = null;\n\n    this.atcCallbacks = options.atcCallbacks;\n\n    // Form\n    this.$form = this.$formArea.find('[data-product-form]');\n    this.$productAtcButton = this.$formArea.find('[data-product-atc]');\n    this.$productVariants = this.$form.find('[data-variants]');\n    this.$productOptions = this.$form.find('[data-product-option]');\n    this.detailsLink = this.$formArea[0].querySelector('[data-product-details-link]');\n    if (this.detailsLink) {\n      this.detailsBaseHref = this.detailsLink.getAttribute('href');\n    }\n\n    this.variantFields = {\n      $price: this.$details.find('[data-price]'),\n      $priceMoney: this.$details.find('[data-price] .money'),\n      $compareAtPrice: this.$details.find('[data-price-compare-at]'),\n      $compareAtPriceMoney: this.$details.find('[data-price-compare-at] .money'),\n      $badge: this.$details.find('[data-badge-sales]'),\n      $badgeMoneySaved: this.$details.find('[data-price-money-saved]'),\n      $badgePercentSaved: this.$details.find('[data-price-percent-saved]'),\n      $sku: this.$details.find('[data-product-sku]'),\n    };\n\n    this.forms = new Forms(this.$form);\n\n    if (this.product && this.product.media.length) {\n      this.gallery = new ProductGallery({\n        el: options.gallery,\n        settings: this.settings,\n        isQuickshop: options.isQuickshop,\n      });\n    }\n\n    this._bindEvents();\n    this._initOptions();\n  }\n\n  unload() {\n    this.$form.off(`.product-details-${this.sectionId}`);\n    this.$window.off(`.product-details-${this.sectionId}`);\n    this.forms.unload();\n\n    if (this.variantHelper) {\n      this.variantHelper.unload();\n    }\n\n    if (this.gallery) {\n      this.gallery.unload();\n    }\n  }\n\n  _bindEvents() {\n    this.$window.on(`shopify-variants:switch-variant.product-details-${this.sectionId}`, (event, data) => this._switchVariant(event, data));\n    this.$form.on(`submit.product-details-${this.sectionId}`, event => this._AddToCartFlyout(event));\n  }\n\n  _initOptions() {\n    if (!this.$productVariants.length) return;\n\n    this.variantHelper = new ShopifyVariants(\n      this.product,\n      this.$productVariants,\n      this.$productOptions,\n      { mixedControls: true },\n    );\n\n    this.variantHelper.selectVariant(this.initialVariant);\n  }\n\n  _switchVariant(event, data) {\n    if (data.product !== this.product) return;\n\n    const {\n      variant,\n      firstLoad,\n    } = data;\n\n    if (firstLoad) {\n      return;\n    }\n\n    // Update main select\n    this.$productVariants.val(data.variant.id);\n    this.gallery.selectMediaByVariant(variant);\n\n    // Update Variant information\n    this._updatePrice(variant);\n    this._updateSKU(variant);\n    this._updateBadge(variant);\n    this._updateButton(variant);\n    this._updateSwatchLabel(variant);\n    this._updateFullDetailsLink(variant);\n\n    if (this.useHistory) {\n      const url = `${this.product.handle}?${$.param({ variant: variant.id })}`;\n      history.replaceState({}, 'variant', url);\n    }\n  }\n\n  _updatePrice(variant) {\n    // Update compare at price\n    const hasComparePrice = (\n      !!variant.compare_at_price && variant.compare_at_price > variant.price\n    );\n    this.variantFields.$compareAtPrice.toggleClass('visible', hasComparePrice);\n    this.variantFields.$compareAtPriceMoney.text(\n      Shopify.formatMoney(variant.compare_at_price, this.settings.money_format),\n    );\n    CurrencyConverter.update(this.variantFields.$compareAtPriceMoney[0]);\n\n    // Update price\n    this.variantFields.$priceMoney.text(\n      Shopify.formatMoney(variant.price, this.settings.money_format),\n    );\n    CurrencyConverter.update(this.variantFields.$priceMoney[0]);\n  }\n\n  _updateSKU(variant) {\n    if (variant.sku === '') {\n      this.variantFields.$sku.parent().addClass('product-sku--empty');\n    } else {\n      this.variantFields.$sku.parent().removeClass('product-sku--empty');\n    }\n\n    this.variantFields.$sku.text(variant.sku);\n  }\n\n  _updateBadge(variant) {\n    const priceSaved = variant.compare_at_price ? variant.compare_at_price - variant.price : 0;\n    this.variantFields.$badge.toggle(!!priceSaved);\n\n    if (this.variantFields.$badgeMoneySaved.length) {\n      // Update badge if it shows money saved\n      this.variantFields.$badgeMoneySaved.text(\n        Shopify.formatMoney(priceSaved, this.settings.money_format),\n      );\n      CurrencyConverter.update(this.variantFields.$badgeMoneySaved[0]);\n    }\n\n    if (this.variantFields.$badgePercentSaved.length) {\n      // Update badge if it shows percentiles\n      const percentileSaved = Math.round((priceSaved * 100) / variant.compare_at_price);\n      this.variantFields.$badgePercentSaved.text(percentileSaved);\n    }\n  }\n\n  _updateButton(variant) {\n    if (variant.available) {\n      this.$productAtcButton.text(this.context.product_available);\n      this.$productAtcButton\n        .removeClass('disabled')\n        .prop('disabled', false);\n    } else {\n      this.$productAtcButton.text(this.context.product_unavailable);\n      this.$productAtcButton\n        .addClass('disabled')\n        .prop('disabled', true);\n    }\n  }\n\n  _updateSwatchLabel(variant) {\n    if (this.settings.swatches_enable) {\n      const swatchLabel = this.$form[0].querySelector('[data-option-swatch-value]');\n      if (swatchLabel) {\n        swatchLabel.innerText = variant.options[parseInt(swatchLabel.dataset.optionSwatchValue, 10)];\n      }\n    }\n  }\n\n  _updateFullDetailsLink(variant) {\n    if (this.detailsLink) {\n      this.detailsLink.setAttribute('href', `${this.detailsBaseHref}?variant=${variant.id}`);\n    }\n  }\n\n  _AddToCartFlyout(event) {\n    event.preventDefault();\n\n    const formData = this.$form.serializeArray();\n\n    const options = {\n      $atcButton: this.$productAtcButton,\n      settings: {\n        moneyFormat: this.settings.money_format,\n        cartRedirection: this.settings.cart_redirection,\n      },\n    };\n\n    AddToCartFlyout.init(formData, options, this.atcCallbacks);\n  }\n}\n","export default class Images {\n  /**\n   * Preloads an image in memory and uses the browsers cache to store it until needed.\n   *\n   * @param {Array} images - A list of image urls\n   * @param {String} size - A shopify image size attribute\n   */\n  preload(images, size) {\n    let imageArray = images;\n    if (typeof images === 'string') {\n      imageArray = [images];\n    }\n\n    for (let i = 0; i < imageArray.length; i++) {\n      this.loadImage(this.getSizedImageUrl(imageArray[i], size));\n    }\n  }\n\n  /**\n   * Loads and caches an image in the browsers cache.\n   *\n   * @param {string} path - An image url\n   */\n  loadImage(path) {\n    const image = new Image();\n    image.src = path;\n    return image;\n  }\n\n  /**\n   * Adds a Shopify size attribute to a URL\n   *\n   * @param src\n   * @param size\n   * @returns {*}\n   */\n  getSizedImageUrl(src = null, size) {\n    if (!size) {\n      return null;\n    }\n\n    if (size === 'master') {\n      return this.removeProtocol(src);\n    }\n\n    const match = src.match(/\\.(jpg|jpeg|gif|png|bmp|bitmap|tiff|tif)(\\?v=\\d+)?$/i);\n\n    if (match) {\n      const prefix = src.split(match[0]);\n      const suffix = match[0];\n\n      return this.removeProtocol(`${prefix[0]}_${size}${suffix}`);\n    }\n\n    console.warn(`No ${size} found for '${src}`);\n    return null;\n  }\n\n  removeProtocol(path) {\n    return path.replace(/http(s)?:/, '');\n  }\n}\n","import $ from 'jquery';\nimport CurrencyConverter from 'shopify-currency-converter';\nimport {\n  trapFocus,\n  removeTrapFocus,\n} from '@shopify/theme-a11y';\n\nimport MessageBanner from './MessageBanner';\nimport Images from '../helpers/Images';\n\nclass AddToCartFlyout {\n  constructor() {\n    this.formData = {};\n    this.settings = {};\n    this.events = [];\n    this.Images = new Images();\n    this.flyOutSelector = '[data-atc-banner]';\n    this.$atcTemplate = $(`[data-templates] ${this.flyOutSelector}`);\n    this.activeElement = null;\n    this.itemId = null;\n\n    this.atcFlyOut = document.querySelector(this.flyOutSelector);\n\n    this._onInit = this._onInit.bind(this);\n    this._onError = this._onError.bind(this);\n    this._onSuccess = this._onSuccess.bind(this);\n    this._onCloseAll = this._onCloseAll.bind(this);\n    this._handleDocumentClick = this._handleDocumentClick.bind(this);\n\n    this._closeEsc = this._closeEsc.bind(this);\n\n    this.messageBanner = new MessageBanner();\n\n    this.header = document.querySelector('[data-site-header]');\n    this.headerAnnouncement = document.querySelector('[data-site-header-announcement]');\n    this.$header = $(this.header);\n    this.$body = $(document.body);\n  }\n\n  init(formData, options, callbacks = {}) {\n    this.formData = formData;\n\n    // Allows ATC Flow to be overridden\n    this.callbacks = $.extend({\n      onInit: this._onInit,\n      onError: this._onError,\n      onSuccess: this._onSuccess,\n      onClose: this._onCloseAll,\n    }, callbacks);\n\n    const { $atcButton } = options;\n\n    this.settings = $.extend({\n      moneyFormat: null,\n      cartRedirection: false,\n    }, options.settings);\n\n    // If any FlyOuts are fully open, close them\n    this._closeFlyOuts();\n\n    this.callbacks.onInit();\n\n    this.activeElement = document.activeElement;\n\n    this._disableButton($atcButton);\n    this._updateCart($atcButton);\n  }\n\n  unload() {\n    this.messageBanner.dismissBanners();\n    this._removeFlyOuts();\n    delete this.Images;\n  }\n\n  _updateCart($atcButton) {\n    const $flyOut = this.$atcTemplate.clone();\n\n    const quantityField = this.formData.filter(data => data.name === 'quantity');\n    const quantity = quantityField[0].value;\n\n    $.ajax({\n      type: 'POST',\n      url: '/cart/add.js',\n      data: $.param(this.formData),\n      dataType: 'json',\n    })\n      .done(response => {\n        this.itemId = response.id;\n\n        if (response.image) {\n          const imageUrl = this.Images.getSizedImageUrl(response.image, '200x');\n          this.Images.loadImage(imageUrl);\n\n          $flyOut.find('[data-atc-banner-product-image]')\n            .html(`<img src=\"${imageUrl}\" alt=\"${response.product_title}\">`);\n        }\n\n        $flyOut.find('[data-atc-banner-product-title]')\n          .text(response.product_title);\n\n        /*\n          TODO: Bring in `variant.options`, iterate through to get option\n            name for: <strong>Option name:</strong> Option\n        */\n        if (response.variant_options[0] !== 'Title' && response.variant_options[0] !== 'Default Title') {\n          $flyOut.find('[data-atc-banner-product-options]')\n            .text(response.variant_options.join(', '));\n        }\n\n        /*\n          TODO: Bring in variant, and use that to check compare_at_price\n            to see if the item is on sale\n        */\n        const $productPriceQuantity = $flyOut.find('[data-atc-banner-product-price-quantity]');\n        $productPriceQuantity.text(`${quantity} × `);\n\n        $.ajax({\n          type: 'GET',\n          url: '/cart.js',\n          dataType: 'json',\n        })\n          .done(secondResponse => {\n            if (this.settings.cartRedirection) {\n              location.href = '/cart';\n              return;\n            }\n\n            this.callbacks.onSuccess();\n\n            // Reset formData in case instance is never cleared\n            this.formData = {};\n\n            let lineItem = null;\n            secondResponse.items.forEach(item => {\n              if (item.id === this.itemId) {\n                if (!lineItem) {\n                  lineItem = item;\n                } else {\n                  // If there are 2 lineItems with the same id, it means that there is\n                  // likely a BOGO offer on the product. We need to grab the highest discounted\n                  // price (BOGO will be 0) while also combining with the different discounts on\n                  // the product in the discounts array.\n                  lineItem.line_level_discount_allocations = lineItem\n                    .line_level_discount_allocations.concat(item.line_level_discount_allocations);\n                  lineItem.final_price = lineItem.final_price > item.final_price\n                    ? lineItem.final_price\n                    : item.final_price;\n                  lineItem.quantity += item.quantity;\n                }\n              }\n            });\n\n            const $productPriceValue = $flyOut.find('[data-atc-banner-product-price-value]');\n            $productPriceValue.text(\n              Shopify.formatMoney(lineItem.original_price, this.settings.moneyFormat),\n            );\n\n            // Update price to local currency\n            CurrencyConverter.update($productPriceValue[0]);\n\n            const $productPriceDiscounted = $flyOut.find('[data-atc-banner-product-price-discounted]');\n            if (lineItem.final_price < lineItem.original_price) {\n              $productPriceDiscounted.text(\n                Shopify.formatMoney(lineItem.final_price, this.settings.moneyFormat),\n              );\n              // Update price to local currency\n              CurrencyConverter.update($productPriceDiscounted[0]);\n\n              $productPriceDiscounted.show();\n              $productPriceValue.addClass('original-price');\n            } else {\n              $productPriceDiscounted.hide();\n              $productPriceValue.removeClass('original-price');\n            }\n\n            const $productDiscounts = $flyOut.find('[data-atc-banner-product-discounts]');\n            if (lineItem.line_level_discount_allocations.length > 0) {\n              const discountItemTemplate = $productDiscounts.children().first();\n              $productDiscounts.empty();\n\n              lineItem.line_level_discount_allocations.forEach(discount => {\n                const $listItem = discountItemTemplate.clone();\n                $listItem.find('.discount-title').html(discount.discount_application.title);\n                const $amount = $listItem.find('.discount-amount');\n                $amount.html(discount.amount);\n                $productDiscounts.append($listItem);\n                CurrencyConverter.update($amount[0]);\n              });\n\n              $productDiscounts.show();\n            } else {\n              $productDiscounts.hide();\n            }\n\n            const $subTotal = $flyOut.find('[data-atc-banner-cart-subtotal]');\n            $subTotal.text(\n              Shopify.formatMoney(secondResponse.total_price, this.settings.moneyFormat),\n            );\n            CurrencyConverter.update($subTotal[0]);\n\n            $flyOut\n              .find('[data-atc-banner-cart-button]')\n              .find('span').text(secondResponse.item_count);\n\n            this.$header.append($flyOut);\n\n            // Notifiy Header of new cart count\n            $(window).trigger('cartcount:update', { response: secondResponse });\n\n            this._bindEvents($flyOut);\n            this._openFlyOut($flyOut, $atcButton);\n          });\n      })\n      .fail(response => {\n        let errorText;\n        try {\n          const responseText = JSON.parse(response.responseText);\n          errorText = responseText.description;\n        } catch (error) {\n          errorText = `${response.status} ${response.statusText}`;\n          if (response.status === 401) {\n            errorText = `${errorText}. Try refreshing and logging in.`;\n          }\n        }\n\n        this._enableButton($atcButton);\n        this.callbacks.onError(errorText);\n      });\n  }\n\n  _onError(error) {\n    this.messageBanner.message(error, 'error');\n  }\n\n  _onInit() {\n    this.messageBanner.dismissBanners();\n  }\n\n  _onSuccess() {\n    /*\n      By default, the ATC Flyout doesn't need any additional success callbacks\n\n      The `this.callbacks.onSuccess` is used to allow other views to initiate\n      behaviour when a product has been added to the cart\n     */\n  }\n\n  _onCloseAll() {\n    /*\n      By default, the ATC Flyout doesn't need any additional close callbacks\n\n      The `this.callbacks.onClose` is used to allow other views to initiate\n      behaviour when the atc banner has been closed\n     */\n  }\n\n  _bindEvents($flyOut) {\n    this.events.push([\n      $flyOut.on('click.atc-banner', '[data-atc-banner-close]', event => {\n        event.preventDefault();\n        this._closeFlyOut($flyOut);\n      }),\n      $(document).on('touchstart.atc-banner, click.atc-banner', this._handleDocumentClick),\n    ]);\n  }\n\n  /**\n   * Trigger any existing open FlyOuts to close\n   *\n   * @private\n   */\n  _closeFlyOuts($excludeFlyOut = null) {\n    $(this.flyOutSelector).filter('[data-flyout-active]').each((index, el) => {\n      const $flyOut = $(el);\n\n      if ($excludeFlyOut && $flyOut.is($excludeFlyOut)) {\n        return;\n      }\n\n      this._closeFlyOut($flyOut, index);\n    });\n\n    if (!$excludeFlyOut) {\n      this.callbacks.onClose();\n    }\n\n    window.removeEventListener('keydown', this._closeEsc);\n  }\n\n  _openFlyOut($flyOut, $atcButton) {\n    /*\n     If user has initiated a new ATC Flow before the first has finished,\n     the first FlyOut could have opened after the first attempt to close open flyouts\n    */\n    this._closeFlyOuts($flyOut);\n\n    $flyOut\n      .addClass('animating animating-in')\n      .one('trend', () => {\n        $flyOut\n          .removeClass('animating animating-in')\n          .addClass('visible')\n          .off('trend');\n\n        $flyOut.attr('data-flyout-active', true);\n\n        trapFocus($flyOut[0]);\n\n        window.addEventListener('keydown', this._closeEsc);\n\n        this._enableButton($atcButton);\n      });\n  }\n\n  _closeEsc(e) {\n    if (e.key === 'Escape') {\n      this._closeFlyOuts();\n    }\n  }\n\n  /**\n   * Close an open FlyOut\n   *\n   * @param $flyOut\n   * @param index\n   * @private\n   */\n  _closeFlyOut($flyOut = null, index = 0) {\n    if (!$flyOut) {\n      return;\n    }\n\n    $flyOut\n      .addClass('animating animating-out')\n      .one('trend', () => {\n        $flyOut\n          .removeClass('animating animating-out visible')\n          .one('trend', () => {\n            $flyOut.off('trend');\n            this._removeFlyOut($flyOut, index);\n\n            // if the user clicked onto the search box, close the atc flyout and move focus\n            // to the search instead of going to the previous active element.\n            if (this.documentClickEventTarget && 'liveSearchInput' in this.documentClickEventTarget.dataset) {\n              this.documentClickEventTarget.focus();\n            } else if (this.activeElement) {\n              this.activeElement.focus();\n            }\n\n            removeTrapFocus($flyOut[0]);\n            this.callbacks.onClose();\n          });\n      });\n  }\n\n  _removeFlyOuts() {\n    $(this.flyOutSelector).filter('[data-flyout-active]').each((index, el) => {\n      this._removeFlyOut($(el), index);\n    });\n  }\n\n  /**\n   * Remove the Flyout from the DOM, and clean up listeners\n   *\n   * @param $flyOut\n   * @param index\n   * @private\n   */\n  _removeFlyOut($flyOut, index) {\n    if (this.events[index]) {\n      this.events[index].forEach($el => $el.off('.atc-banner'));\n      this.events.splice(index, 1);\n    }\n\n    if ($flyOut) {\n      $flyOut.remove();\n    }\n  }\n\n  _disableButton($atcButton) {\n    $atcButton\n      .addClass('processing')\n      .prop('disabled', true);\n  }\n\n  _enableButton($atcButton) {\n    $atcButton\n      .prop('disabled', false)\n      .removeClass('processing');\n  }\n\n  _handleDocumentClick(event) {\n    const { target } = event;\n    const $parent = $(target).parents('[data-atc-banner]');\n\n    if ($parent.length) {\n      return;\n    }\n\n    this.documentClickEventTarget = target;\n    this._closeFlyOuts();\n  }\n}\n\nexport default new AddToCartFlyout();\n","import $ from 'jquery';\n\nconst eventHandlers = [];\nlet previousBreakpoint = null;\n\nfunction getBreakpoints() {\n  return window\n    .getComputedStyle(document.documentElement, ':before')\n    .getPropertyValue('content')\n    .replace(/\"/g, '')\n    .split(',');\n}\n\nfunction getBreakpoint() {\n  return window\n    .getComputedStyle(document.documentElement, ':after')\n    .getPropertyValue('content')\n    .replace(/\"/g, '');\n}\n\n$(window).on('resize', event => {\n  const currentBreakpoint = getBreakpoint();\n\n  if (previousBreakpoint !== currentBreakpoint) {\n    eventHandlers.forEach(eventHandler => {\n      eventHandler(event, {\n        previous: previousBreakpoint,\n        current: currentBreakpoint,\n      });\n    });\n  }\n\n  previousBreakpoint = currentBreakpoint;\n});\n\nfunction isLessThanBreakpoint(breakpoint, inclusive = false) {\n  const breakpoints = getBreakpoints();\n  const currentBreakpoint = getBreakpoint();\n  const comparison = breakpoints.indexOf(currentBreakpoint) - breakpoints.indexOf(breakpoint);\n\n  return inclusive ? comparison <= 0 : comparison < 0;\n}\n\nfunction isGreaterThanBreakpoint(breakpoint, inclusive = false) {\n  const breakpoints = getBreakpoints();\n  const currentBreakpoint = getBreakpoint();\n  const comparison = breakpoints.indexOf(currentBreakpoint) - breakpoints.indexOf(breakpoint);\n\n  return inclusive ? comparison >= 0 : comparison > 0;\n}\n\nfunction isBreakpoint(...breakpoints) {\n  const currentBreakpoint = getBreakpoint();\n  return breakpoints.some(breakpoint => breakpoint === currentBreakpoint);\n}\n\nfunction onBreakpointChange(eventHandler) {\n  if (eventHandlers.indexOf(eventHandler) === -1) {\n    eventHandlers.push(eventHandler);\n  }\n}\n\nfunction offBreakpointChange(eventHandler) {\n  const index = eventHandlers.indexOf(eventHandler);\n\n  if (index !== -1) {\n    eventHandlers.splice(index, 1);\n  }\n}\n\nexport default {\n  isLessThanBreakpoint,\n  isGreaterThanBreakpoint,\n  isBreakpoint,\n  onBreakpointChange,\n  offBreakpointChange,\n};\n","export default class Quantity {\n  constructor(el) {\n    this.$el = $(el);\n    this.$inputParent = this.$el.find('.form-field--qty-input');\n    this.$input = this.$el.find('[data-quantity-input]');\n    this.$selectParent = this.$el.find('.form-field--qty-select');\n    this.$select = this.$el.find('[data-quantity-select]');\n\n    this._watchSelect = this._watchSelect.bind(this);\n    this._watchInput = this._watchInput.bind(this);\n\n    this.$select.on('change.quantity', this._watchSelect);\n    this.$input.on('change.quantity', this._watchInput);\n  }\n\n  unload() {\n    this.$el.off('.quantity');\n  }\n\n  _validateValue(event) {\n    const baseValue = parseInt(event.currentTarget.value, 10);\n\n    return isNaN(baseValue) ? 1 : baseValue;\n  }\n\n  _watchSelect(event) {\n    const value = this._validateValue(event);\n\n    // Update input to match select\n    this.$input.val(value).trigger('change');\n\n    // Switch to quantity input when 10 or more\n    if (value >= 10) {\n      this.$inputParent\n        .removeClass('hidden')\n        .addClass('visible');\n\n      this.$input\n        .focus()\n        .removeAttr('tabindex')\n        .select();\n\n      this.$selectParent\n        .removeClass('visible')\n        .addClass('hidden');\n\n      this.$select.attr('tabindex', '-1');\n    }\n  }\n\n  _watchInput(event) {\n    this.$input.val(this._validateValue(event));\n  }\n}\n","import $ from 'jquery';\nimport Quantity from './helpers/Quantity';\n\nexport default class Forms {\n  constructor(el, selector = '.form-field-input') {\n    this.$el = $(el);\n    this.filledClass = 'form-field-filled';\n    this.fieldSelector = selector;\n\n    this.quantityItems = [];\n    this.$quantityWrapper = this.$el.find('[data-quantity-wrapper]');\n\n    this._toggleFilled = this._toggleFilled.bind(this);\n    this.$el.on('focus.forms', this.fieldSelector, this._toggleFilled);\n    this.$el.on('blur.forms', this.fieldSelector, this._toggleFilled);\n\n    this._checkFilled();\n\n    if (this.$quantityWrapper.length) {\n      this.$quantityWrapper.each((i, el) => {\n        this.quantityItems.push(\n          new Quantity(el),\n        );\n      });\n    }\n  }\n\n  unload() {\n    this.$el.off('.forms');\n\n    this.quantityItems.forEach(quantityItem => {\n      quantityItem.unload();\n    });\n  }\n\n  _checkFilled() {\n    this.$el.find(this.fieldSelector).each((i, el) => {\n      if ($(el).hasClass(this.filledClass)) return;\n\n      this._toggleFilled(null, el);\n    });\n  }\n\n  _toggleFilled(event = null, el = false) {\n    const target = event ? event.currentTarget : el;\n    const $target = $(target);\n    const { value } = target;\n\n    let isFilled = value.length > 0;\n\n    try {\n      isFilled = isFilled || $target.is(':-webkit-autofill');\n      $target.toggleClass(this.filledClass, isFilled);\n    } catch (e) {\n      $target.toggleClass(this.filledClass, isFilled);\n    }\n  }\n}\n"],"sourceRoot":""}