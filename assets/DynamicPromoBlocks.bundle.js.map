{"version":3,"sources":["webpack:///./source/scripts/Layout.js","webpack:///./source/scripts/sections/DynamicPromoBlocks.js"],"names":["eventHandlers","previousBreakpoint","getBreakpoints","window","getComputedStyle","document","documentElement","getPropertyValue","replace","split","getBreakpoint","$","on","event","currentBreakpoint","forEach","eventHandler","previous","current","isLessThanBreakpoint","breakpoint","inclusive","breakpoints","comparison","indexOf","isGreaterThanBreakpoint","isBreakpoint","some","onBreakpointChange","push","offBreakpointChange","index","splice","adjustHeight","block","$block","$wrapper","find","padding","innerHeight","css","height","transform","top","resetHeight","DynamicPromoBlocks","section","$el","el","content","expandedClass","compressBlocks","data","compress_blocks","layoutHandler","bind","layout","_blockInteraction","each","i","_collapse","off","_expand","querySelector","currentTarget","clicked","getAttribute","preventDefault","setAttribute","$content","addClass","one","removeClass","removeAttribute"],"mappings":"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","file":"DynamicPromoBlocks.bundle.js","sourcesContent":["import $ from 'jquery';\n\nconst eventHandlers = [];\nlet previousBreakpoint = null;\n\nfunction getBreakpoints() {\n  return window\n    .getComputedStyle(document.documentElement, ':before')\n    .getPropertyValue('content')\n    .replace(/\"/g, '')\n    .split(',');\n}\n\nfunction getBreakpoint() {\n  return window\n    .getComputedStyle(document.documentElement, ':after')\n    .getPropertyValue('content')\n    .replace(/\"/g, '');\n}\n\n$(window).on('resize', event => {\n  const currentBreakpoint = getBreakpoint();\n\n  if (previousBreakpoint !== currentBreakpoint) {\n    eventHandlers.forEach(eventHandler => {\n      eventHandler(event, {\n        previous: previousBreakpoint,\n        current: currentBreakpoint,\n      });\n    });\n  }\n\n  previousBreakpoint = currentBreakpoint;\n});\n\nfunction isLessThanBreakpoint(breakpoint, inclusive = false) {\n  const breakpoints = getBreakpoints();\n  const currentBreakpoint = getBreakpoint();\n  const comparison = breakpoints.indexOf(currentBreakpoint) - breakpoints.indexOf(breakpoint);\n\n  return inclusive ? comparison <= 0 : comparison < 0;\n}\n\nfunction isGreaterThanBreakpoint(breakpoint, inclusive = false) {\n  const breakpoints = getBreakpoints();\n  const currentBreakpoint = getBreakpoint();\n  const comparison = breakpoints.indexOf(currentBreakpoint) - breakpoints.indexOf(breakpoint);\n\n  return inclusive ? comparison >= 0 : comparison > 0;\n}\n\nfunction isBreakpoint(...breakpoints) {\n  const currentBreakpoint = getBreakpoint();\n  return breakpoints.some(breakpoint => breakpoint === currentBreakpoint);\n}\n\nfunction onBreakpointChange(eventHandler) {\n  if (eventHandlers.indexOf(eventHandler) === -1) {\n    eventHandlers.push(eventHandler);\n  }\n}\n\nfunction offBreakpointChange(eventHandler) {\n  const index = eventHandlers.indexOf(eventHandler);\n\n  if (index !== -1) {\n    eventHandlers.splice(index, 1);\n  }\n}\n\nexport default {\n  isLessThanBreakpoint,\n  isGreaterThanBreakpoint,\n  isBreakpoint,\n  onBreakpointChange,\n  offBreakpointChange,\n};\n","import $ from 'jquery';\nimport layout from '../Layout';\n\n// Adjusts the height of the block so it can contain the wrapper within it\nconst adjustHeight = block => {\n  const $block = $(block);\n  const $wrapper = $block.find('.promo-block--content-wrapper');\n\n  const padding = window.getComputedStyle($block[0], null).getPropertyValue('padding-top').replace('px', '');\n\n  if ($block.innerHeight() - (padding * 2) < $wrapper.innerHeight()) {\n    $block.css({ height: `${$wrapper.innerHeight() + (padding * 2)}px` });\n    $wrapper.css({ transform: 'none', top: 'auto' });\n  }\n};\n\n// Removes height settings on the block because they only need to be there for small screens\nconst resetHeight = block => {\n  const $block = $(block);\n  const $wrapper = $block.find('.promo-block--content-wrapper');\n  $block.css({ height: '' });\n  $wrapper.css({ transform: '', top: '' });\n};\n\nexport default class DynamicPromoBlocks {\n  constructor(section) {\n    this.$el = $(section.el);\n    this.content = '[data-promo-block-content]';\n    this.expandedClass = 'promo-block--expanded';\n    this.compressBlocks = section.data.compress_blocks;\n\n    // Revert navigation to original state on breakpoint change\n    this.layoutHandler = this.onBreakpointChange.bind(this);\n    layout.onBreakpointChange(this.layoutHandler);\n\n    this._blockInteraction = this._blockInteraction.bind(this);\n\n    this.$el.on('click.promo-block', this.content, this._blockInteraction);\n    if (!this.compressBlocks && layout.isLessThanBreakpoint('S')) {\n      this.$el.find(this.content).each((index, block) => {\n        adjustHeight(block);\n      });\n    }\n\n    if (!this.compressBlocks) {\n      $(window).on('resize', () => {\n        this.$el.find(this.content).each((index, block) => {\n          if (layout.isLessThanBreakpoint('S')) {\n            adjustHeight(block);\n          } else {\n            resetHeight(block);\n          }\n        });\n      });\n    }\n  }\n\n  /**\n   * Remove block's toggled state and attributes when leaving mobile\n   */\n  onBreakpointChange() {\n    if (!layout.isLessThanBreakpoint('S')) {\n      this.$el.find(`.${this.expandedClass}`).each((i, content) => {\n        this._collapse(content);\n      });\n\n      this.$el.find(this.content).each((index, block) => {\n        resetHeight(block);\n      });\n    } else if (!this.compressBlocks) {\n      this.$el.find(this.content).each((index, block) => {\n        adjustHeight(block);\n      });\n    }\n  }\n\n  /**\n   * Unbind events when section is re-drawn\n   */\n  onSectionUnload() {\n    this.$el.off('.promo-block');\n    layout.offBreakpointChange(this.layoutHandler);\n  }\n\n  /**\n   * Callback to open block on mobile from the TE\n   *\n   * @param block\n   */\n  onSectionBlockSelect(block) {\n    if (!layout.isLessThanBreakpoint('S')) return;\n\n    this._expand(block.el.querySelector(this.content));\n  }\n\n  /**\n   * Callback to close block on mobile from the TE\n   *\n   * @param block\n   */\n  onSectionBlockDeselect(block) {\n    if (!layout.isLessThanBreakpoint('S')) return;\n\n    this._collapse(block.el.querySelector(this.content));\n  }\n\n  /**\n   * Expand a block on first click, then allow it to behave as normal\n   *\n   * @param event\n   * @private\n   */\n  _blockInteraction(event) {\n    const content = event.currentTarget;\n    const clicked = content.getAttribute('data-clicked');\n\n    // On second click, or on desktop, don't interfere with block\n    if (clicked || !layout.isLessThanBreakpoint('S') || !this.compressBlocks) {\n      return;\n    }\n\n    event.preventDefault();\n    content.setAttribute('data-clicked', 'clicked');\n\n    this._expand(content);\n  }\n\n  /**\n   * Expand promo block\n   *\n   * @param content\n   * @private\n   */\n  _expand(content) {\n    if (!this.compressBlocks) {\n      return;\n    }\n\n    const $content = $(content);\n\n    $content\n      .addClass('animating animating-in')\n      .one('trend', () => {\n        $content\n          .removeClass('animating animating-in')\n          .addClass(this.expandedClass)\n          .off('trend');\n        adjustHeight($content);\n      });\n  }\n\n  /**\n   * Collapse a block\n   *\n   * @param content\n   * @private\n   */\n  _collapse(content) {\n    if (!this.compressBlocks) {\n      return;\n    }\n\n    const $content = $(content);\n\n    $content\n      .addClass('animating animating-out')\n      .one('trend', () => {\n        $content\n          .removeClass(`animating animating-out ${this.expandedClass}`)\n          .off('trend');\n        content.removeAttribute('data-clicked');\n        resetHeight($content);\n      });\n  }\n}\n"],"sourceRoot":""}