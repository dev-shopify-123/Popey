{"version":3,"sources":["webpack:///./source/scripts/components/search/SearchForm.js","webpack:///./source/scripts/sections/StaticSearch.js"],"names":["sanitizeCategory","value","replace","SearchForm","$container","options","container","form","querySelector","filter","isLiveSearch","liveSearch","setCategory","events","EventHandler","register","e","submitHandler","filterLabel","target","newValue","innerHTML","classList","add","dataset","filterAll","remove","hideFilterIfMobile","Layout","isLessThanBreakpoint","onBreakpointChange","unregisterAll","event","preventDefault","currentTarget","cloneNode","termsInput","style","position","left","bottom","visibility","terms","indexOf","split","join","trim","window","document","body","appendChild","submit","StaticSearch","section","$el","$","el","$searchField","find","productItems","$productItems","each","i","productItem","push","ProductGridItem","id","lazy","_updatePrices","searchForm","unload","forEach","index","CurrencyConverter","update"],"mappings":"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","file":"StaticSearch.bundle.js","sourcesContent":["import EventHandler from '@pixelunion/events';\nimport Layout from '../../Layout';\n\nfunction sanitizeCategory(value) {\n  return value.replace(/(tag|product_type):(searchfilter_)?/, '');\n}\n\nexport default class SearchForm {\n  constructor($container, options = {}) {\n    this.container = $container[0];\n    this.form = this.container.querySelector('[data-live-search-form]');\n    this.filter = this.container.querySelector('[data-live-search-filter]');\n\n    this.isLiveSearch = options.liveSearch ? options.liveSearch : false;\n    this.setCategory = options.setCategory || (() => { /* do nothing */ });\n\n    this.events = new EventHandler();\n\n    this.events.register(this.form, 'submit', e => this.submitHandler(e));\n\n    if (this.filter) {\n      this.filterLabel = this.container.querySelector('[data-live-search-filter-label]');\n\n      // page-search-form uses a hidden input to persist the filter, in which case\n      // this.filter exists, but this.filterLabel does not.\n      if (this.filterLabel) {\n        this.setCategory(this.filterLabel.value);\n\n        this.events.register(this.filter, 'change', e => {\n          const { value } = e.target;\n          if (value) {\n            const newValue = sanitizeCategory(value);\n            this.filterLabel.innerHTML = newValue;\n            this.setCategory(newValue);\n            this.form.classList.add('live-search-filter-active');\n          } else {\n            this.filterLabel.innerHTML = e.target.dataset.filterAll;\n            this.form.classList.remove('live-search-filter-active');\n            this.setCategory('');\n          }\n        });\n      }\n\n      const hideFilterIfMobile = () => {\n        if (Layout.isLessThanBreakpoint('S')) {\n          this.filter.value = '';\n          this.form.classList.remove('live-search-filter-active');\n          if (this.filterLabel) {\n            this.filterLabel.innerHTML = this.filter.dataset.filterAll;\n          }\n        }\n      };\n\n      hideFilterIfMobile();\n      Layout.onBreakpointChange(() => hideFilterIfMobile());\n    }\n  }\n\n  unload() {\n    this.events.unregisterAll();\n  }\n\n  submitHandler(event) {\n    event.preventDefault();\n\n    const form = event.currentTarget.cloneNode(true);\n    const termsInput = form.querySelector('[name=q]');\n\n    form.style.position = 'absolute';\n    form.style.left = '-1000px';\n    form.style.bottom = '-1000px';\n    form.style.visibility = 'hidden';\n\n    let terms = termsInput.value;\n\n    if (this.isLiveSearch && !terms) {\n      return;\n    }\n\n    // Adds `*` after each word in search terms, doesn't add to last word\n    if (terms.indexOf(' ') > 0) {\n      terms = terms.split(' ').join('* ').trim();\n    }\n\n    // Adds `*` at the end of the search terms\n    terms = `${terms}*`;\n\n    // Add field filter\n    terms = this.filter && this.filter.value ? `${terms} ${this.filter.value}` : terms;\n\n    // Update value\n    termsInput.value = terms;\n\n    // Forms must be in the browser context in order to submit\n    window.document.body.appendChild(form);\n    form.submit();\n  }\n}\n","import $ from 'jquery';\nimport CurrencyConverter from 'shopify-currency-converter';\n\nimport ProductGridItem from '../components/ProductGridItem';\nimport SearchForm from '../components/search/SearchForm';\n\nexport default class StaticSearch {\n  constructor(section) {\n    this.section = section;\n    this.$el = $(section.el);\n    this.$searchField = this.$el.find('[data-live-search]');\n\n    // Product items\n    this.productItems = [];\n    const $productItems = this.$el.find('[data-product-item]');\n\n    $productItems.each((i, productItem) => {\n      this.productItems.push(\n        new ProductGridItem({\n          el: productItem,\n          id: this.section.id,\n          lazy: true,\n        }),\n      );\n    });\n\n    this._updatePrices();\n    this.searchForm = new SearchForm(this.$searchField);\n  }\n\n  onSectionUnload() {\n    this.searchForm.unload();\n\n    this.productItems.forEach(productItem => {\n      productItem.unload();\n    });\n  }\n\n  _updatePrices() {\n    this.$el.find('.money:not([data-currency]').each((index, el) => CurrencyConverter.update(el));\n  }\n}\n"],"sourceRoot":""}